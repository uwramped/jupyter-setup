#cloud-config
output: {all: '| tee -a /var/log/cloud-init-output.log'}

package_update: true
package_upgrade: true

packages:
 - emacs24-nox
 - python3-pip
 - python-pip
 - npm
 - nodejs-legacy
 - git
 - texlive-latex-base
 - texlive-fonts-recommended
 - cm-super
 - texlive-latex-extra

users:
 - name: jupyter
   gecos: Jupyter
   sudo: ALL=(ALL) NOPASSWD:ALL
 - name: mike
   gecos: Mike
   sudo: ALL=(ALL) NOPASSWD:ALL
 - name: adam
   gecos: Adam
   sudo: ALL=(ALL) NOPASSWD:ALL
  - name: andrea
  - name: tonia
  - name: mhurley
  - name: crodger
  - name: tharris
  - name: bray
  - name: mmcatee
  - name: jmartin
  - name: skramer
  - name: jthomps
  - name: mtlusto
  - name: mstewar
  - name: mhilema
  - name: yhilema
  - name: pkuberr
  - name: cgraf
  - name: mwesnit
  - name: tfreder
  - name: canders
  - name: rperry
  - name: gvlasto
  - name: dgreen
  - name: resh
  - name: cfoley
  - name: dcypher
  - name: gstott
  - name: klloyd
  - name: jspauld
  - name: clee
  - name: wcurtis
  - name: pkasza
  - name: jjorgen
  - name: vdavis
  - name: cspears

chpasswd:
  list: |
    jupyter:RANDOM
    mike:RANDOM
    adam:RANDOM
    andrea:RANDOM
    tonia:RANDOM
    mhurley:RANDOM
    crodger:RANDOM
    tharris:RANDOM
    bray:RANDOM
    mmcatee:RANDOM
    jmartin:RANDOM
    skramer:RANDOM
    jthomps:RANDOM
    mtlusto:RANDOM
    mstewar:RANDOM
    mhilema:RANDOM
    yhilema:RANDOM
    pkuberr:RANDOM
    cgraf:RANDOM
    mwesnit:RANDOM
    tfreder:RANDOM
    canders:RANDOM
    rperry:RANDOM
    gvlasto:RANDOM
    dgreen:RANDOM
    resh:RANDOM
    cfoley:RANDOM
    dcypher:RANDOM
    gstott:RANDOM
    klloyd:RANDOM
    jspauld:RANDOM
    clee:RANDOM
    wcurtis:RANDOM
    pkasza:RANDOM
    jjorgen:RANDOM
    vdavis:RANDOM
    cspears:RANDOM

ssh_pwauth: False

runcmd:
 - wget http://repo.continuum.io/archive/Anaconda2-4.1.0-Linux-x86_64.sh
 - wget https://raw.githubusercontent.com/uwramped/jupyter-setup/master/jupyterhub_config.py
 - [ mv, "jupyterhub_config.py", "/root/jhc.py"]
 - [ bash, "Anaconda2-4.1.0-Linux-x86_64.sh", -b, -p,"/home/jupyter/anaconda"]
 - [ pip3, "install", "jupyterhub"]
 - [ pip3, "install", "notebook"]
 - [ pip3, "install" ,"ipykernel"]
 - [ pip, "install", "ipykernel"]
 - [ pip, "install", "ipywidgets"]
 - [ pip3, "install", "ipywidgets"]
 - [ npm, "install", -g, "configurable-http-proxy"]
 - [ /home/jupyter/anaconda/bin/python2, -m, "ipykernel", "install"]
 - grep -e "^[[:alpha:]]*:[[:alnum:]]*$" /var/log/cloud-init-output.log  > /tmp/passwd.tmp
 
